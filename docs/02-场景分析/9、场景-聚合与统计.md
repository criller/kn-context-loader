# 场景：聚合与统计（Aggregate / Analytics）【M2】

目标（聚焦用户与业务）
- 基于对象与关系的检索结果进行计数、分组与Top-K排序，为分析与排名类问题提供答案。

用户故事（化工示例，可替换为你们领域）
- AG-001 拥有专利最多的企业Top-K
  - “拥有专利数量最多的企业排名前10”
  - 按TBox的关系路径：enterprise → patent（enterprise_2_patent，正向，一跳）；按企业分组，对边计数，排序取Top-K
  - 期望：返回企业及其专利数量的排名。
- AG-002 参与反应最多的物料Top-K
  - “参与反应数量最多的物质有哪些？”
  - 按TBox的关系路径：material → reaction（material_2_reaction，正向，一跳）；按物料分组，对边计数，排序取Top-K
  - 期望：返回物料及其参与反应数量的排序。
- AG-003 园区企业数量统计
  - “各园区包含的企业数量是多少？”
  - 按TBox的关系路径：enterprise → park（enterprise_2_park，正向，一跳）；以园区为分组口径，对入驻企业计数
  - 期望：按园区分组的企业数量统计列表。

基础能力（文本版）
- 支持对关系或邻域进行计数与分组；
- 支持Top-K排序与limit控制；
- 能够明确统计口径（按边类型、方向（正向/反向/双向）、过滤条件、去重规则等；默认正向）。

注意事项
- 多对多关系可能产生重复，计数口径需约定：按边计数或按实体id去重计数；
- 如需按业务键连接，请明确连接字段（join_fields）与策略（join_strategy），避免统计口径混淆；
- 若暂不具备聚合计算能力，可提供替代方案：分解为多次子图查询并在上层进行聚合（说明精度与性能风险）。